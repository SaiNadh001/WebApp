<!DOCTYPE html> 
<html>
<head>
	<title>Studies</title>
	<link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="../css/custom.css">
</head>
<body>
	<nav class="navbar navbar-default">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="#">BridgeWebApp</a>
			</div>

			<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
				
				<ul class="nav navbar-nav navbar-right">
					<li class="dropdown">
			          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Study <span class="caret"></span></a>
			          <ul class="dropdown-menu" role="menu">
			            <li class="active"><a href="/study">Studies</a></li>
			            <li><a href="/study_consent">Study Consents</a></li>
			            <li class="divider"></li>
			          </ul>
			        </li>
			        <li><a href="/survey_details">Surveys</a></li>
					<li><a href="/consent_signature">Consent Signature</a></li>
					<li><a href="/update_user_profile">Update Profile</a></li>
					<li class="divider"></li>
					<li><a href="/logout">Logout</a></li>
				</ul>
				
			</div>
		</div>
	</nav>
	<div class="jumbotron container">

		<h3 style="text-align:center;"> Studies </h3>
		<table class="table table-striped table-hover ">
		  <thead>
		    <tr>
		      <th>#</th>
		      <th>Name</th>
		      <th>Identifier</th>
		      <th>Type</th>
		    </tr>
		  </thead>
		  <tbody class="studies">
		  </tbody>
		</table> 

</div>
</body>
<script type="text/javascript" src="../js/jquery-1.10.2.min.js"></script>
<script type="text/javascript" src="../js/bootstrap.min.js"></script>
<script type="text/javascript">
function ajax_request(url,type,data,callback){
 $.ajax({
 	url: url, 
 	type:type,
 	data:data,
 	beforeSend: function(xhr) {
	    xhr.setRequestHeader("SessionToken", localStorage.getItem("sessionToken"));
    },
 	success: function(result){
        callback(result)
    }
  });
}
function getData(data){
	console.log(data)
}
function getStudies(){
	ajax_request("/studies","GET","",function(data){
		console.log(data)
		var study=""
		for(i=0 ; i<data.items.length ; i++){
			console.log(data.items[i])
			study = study + "<tr><td>"+(i+1)+"</td><td>"+data.items[i].name+"</td><td>"+data.items[i].identifier+"</td><td>"+data.items[i].type+"</td></tr>"
		}
		$(".studies").append(study)
	});

	
} 



getStudies();

var data ={ 
	   "name":"SampleStudy",
	   "sponsorName":"The DO Study by DreamOrbit",
	   "identifier":"dostudy",
	   "supportEmail":"saibaba.nadh@dreamorbit.com",
	   "technicalEmail":"saibaba.nadh@dreamorbit.com",
	   "consentNotificationEmail":"saibaba.nadh@dreamorbit.com",
	   "minAgeOfConsent":18,
	   "maxNumOfParticipants":1000,
	   "version":9999,
	   "passwordPolicy":{ 
	      "minLength":8,
	      "numericRequired":true,
	      "symbolRequired":true,
	      "lowerCaseRequired":true,
	      "upperCaseRequired":true,
	      "type":"PasswordPolicy"
	   },
	   "verifyEmailTemplate":{ 
	      "subject":"Verify your account",
	      "body":"<p>Hi,</p> \n<p>Thank you for registering for ${studyName}.</p> \n<p>This research study is powered by Bridge, a secure data storage service operated by Sage Bionetworks. In order to proceed, you must first confirm your email address by clicking the link below, or copying and pasting it into the address bar of your browser:</p> \n<p>${url}</p> \n<p>Once you confirm your email, you will be able to finish setting up your profile for the study.</p> \n<p>Regards,</p> \n<p>${sponsorName}</p> \n<p>For general inquiries or to request support with your account, please email ${supportEmail}</p>",
	      "mimeType":"html",
	      "type":"EmailTemplate"
	   },
	   "resetPasswordTemplate":{ 
	      "subject":"${studyName} password reset",
	      "body":"<p>Forgot your password?</p> \n<p>We've received a request to reset the password for this email address.</p> \n<p>To reset your password please click on this link or cut and paste this URL into your browser (link expires in ${expirationWindow} hours):</p> \n<p>${url}</p> \n<p>This link takes you to a secure page where you can change your password.</p> \n<p>If you don't want to reset your password, please ignore this message. Your password will not be reset.</p>\n<p>For general inquiries or to request support with your account, please email ${supportEmail}</p>",
	      "mimeType":"html",
	      "type":"EmailTemplate"
	   },
	   "userProfileAttributes":["can_recontact"],
	   "consentHTML":"/consent.html",
	   "consentPDF":"/consent.pdf",
	   "type":"Study"
	}

</script>
</html>